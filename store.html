<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Delight Dental Care - Store</title>
<link rel="icon" href="favicon.ico" type="image/x-icon"><!-- Place your favicon/logo here -->
<style>
body { font-family: Arial, sans-serif; margin:0; background:#f9f9f9; color:#333; }
header { background:#008080; color:white; padding:15px; text-align:center; font-size:1.5rem; font-weight:bold; }
nav { background:#006666; padding:10px; text-align:center; }
nav a { color:white; text-decoration:none; margin:0 15px; font-weight:bold; }
nav a:hover { text-decoration:underline; }
.container { max-width:1200px; margin:0 auto; padding:20px; }
#categoryMenu { text-align:center; margin:20px 0; }
#categoryMenu button { padding:10px 20px; margin:5px; border:none; border-radius:5px; background:#008080; color:white; font-weight:bold; cursor:pointer; }
#categoryMenu button:hover { background:#006666; }
.product-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:20px; }
.card { background:white; border-radius:12px; box-shadow:0 3px 8px rgba(0,0,0,0.1); overflow:hidden; transition:transform 0.2s; position:relative; }
.card:hover { transform:scale(1.03); }
.card img { width:100%; height:200px; object-fit:cover; }
.card-content { padding:15px; text-align:center; }
.card-content h3 { margin:10px 0; color:#008080; }
.card-content p { font-size:0.9rem; margin:10px 0; }
.price { font-size:1.1rem; font-weight:bold; color:#006666; margin:10px 0; }
.contact-btns { text-align:center; padding:10px; }
.contact-btns a { display:inline-block; padding:10px 15px; margin:5px; border-radius:6px; color:white; text-decoration:none; font-weight:bold; }
.whatsapp { background:#25D366; }
.call { background:#008080; }
.whatsapp:hover { background:#1ebe5c; }
.call:hover { background:#006666; }
.admin-btns { margin-top:10px; text-align:center; }
.admin-btns button { margin:5px; padding:6px 12px; border:none; border-radius:5px; cursor:pointer; }
.admin-btns button.edit { background:#008080; color:white; }
.admin-btns button.delete { background:#FF6347; color:white; }
#adminPanel { display:none; padding:30px; background:#f9f9f9; justify-content:center; margin-bottom:50px; }
.admin-box { background:white; padding:20px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.2); max-width:500px; width:100%; }
#loginPanel { text-align:center; margin:30px; }
footer { background:#008080; color:white; text-align:center; padding:15px; margin-top:30px; }
</style>
</head>
<body>

<header>ü¶∑ Delight Dental Care - Online Store</header>
<nav>
<a href="index.html">Home</a>
<a href="store.html">Products</a>
<a href="#reviews">Reviews</a>
<a href="contact.html">Contact</a>
</nav>

<div class="container">
<h2 style="text-align:center;color:#008080;">üõçÔ∏è Our Products</h2>
<div id="categoryMenu">
<button onclick="displayProducts('All')">All</button>
<button onclick="displayProducts('Toothpaste')">Toothpaste</button>
<button onclick="displayProducts('Mouthwash')">Mouthwash</button>
<button onclick="displayProducts('Whitening')">Whitening</button>
<button onclick="displayProducts('Dental Tools')">Dental Tools</button>
<button onclick="displayProducts('Others')">Others</button>
</div>
<div id="productGrid" class="product-grid"></div>
</div>

<!-- Admin login -->
<div id="loginPanel">
<h2>üîí Admin Login</h2>
<input type="password" id="adminPassword" placeholder="Enter password">
<button onclick="checkPassword()" style="padding:10px 20px; background:#008080; color:white; border:none; border-radius:6px;">Login</button>
</div>

<!-- Admin panel -->
<div id="adminPanel">
<div class="admin-box">
<h2>üì¶ Add / Edit Product</h2>
<input type="file" id="productImage" accept="image/*"><br><br>
<input type="text" id="productName" placeholder="Product name"><br><br>
<input type="text" id="productPrice" placeholder="Price"><br><br>
<textarea id="productDesc" placeholder="Description"></textarea><br><br>
<select id="productCategory">
<option value="Toothpaste">Toothpaste</option>
<option value="Mouthwash">Mouthwash</option>
<option value="Whitening">Whitening</option>
<option value="Dental Tools">Dental Tools</option>
<option value="Others">Others</option>
</select><br><br>
<button id="uploadBtn" onclick="uploadProduct()" style="padding:10px 20px; background:#008080; color:white; border:none; border-radius:6px;">Upload Product</button>
<button id="updateBtn" style="padding:10px 20px; background:#FFA500; color:white; border:none; border-radius:6px; display:none;" onclick="updateProduct()">Update Product</button>
<input type="hidden" id="editProductId">
</div>
</div>

<footer>&copy; 2025 Delight Dental Care | All Rights Reserved</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-storage.js";

// Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyD1uU1UZdioHQWF7etIZ0tmz2MkwGhmThU",
  authDomain: "delight-program.firebaseapp.com",
  projectId: "delight-program",
  storageBucket: "delight-program.appspot.com",
  messagingSenderId: "972498440796",
  appId: "1:972498440796:web:e1220bf5dd8e82b7a0cc99"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);

const password = "mubsbatir";
let allProducts = [];

// Admin Login
window.checkPassword = function(){
  const input = document.getElementById("adminPassword").value;
  if(input===password){
    document.getElementById("loginPanel").style.display="none";
    document.getElementById("adminPanel").style.display="flex";
    loadProducts();
  } else { alert("Wrong password!"); }
}

// Upload Product
window.uploadProduct = async function(){
  const file = document.getElementById("productImage").files[0];
  const name = document.getElementById("productName").value;
  const price = document.getElementById("productPrice").value;
  const desc = document.getElementById("productDesc").value;
  const category = document.getElementById("productCategory").value;

  if(!file || !name || !price || !desc){ alert("Please fill all fields"); return; }

  try{
    const storageRef = ref(storage, "products/"+Date.now()+"_"+file.name);
    await uploadBytes(storageRef, file);
    const imageUrl = await getDownloadURL(storageRef);

    await addDoc(collection(db,"products"), {name, price, desc, category, imageUrl});
    alert("Product uploaded successfully!");
    clearForm();
    loadProducts();
  } catch(err){
    console.error(err);
    alert("Upload failed. Check Firebase rules and network.");
  }
}

// Delete Product
window.deleteProduct = async function(id){
  if(confirm("Delete this product?")){
    await deleteDoc(doc(db,"products",id));
    loadProducts();
  }
}

// Edit Product
window.editProduct = function(product){
  document.getElementById("productName").value = product.name;
  document.getElementById("productPrice").value = product.price;
  document.getElementById("productDesc").value = product.desc;
  document.getElementById("productCategory").value = product.category;
  document.getElementById("editProductId").value = product.id;
  document.getElementById("uploadBtn").style.display="none";
  document.getElementById("updateBtn").style.display="inline-block";
}

// Update Product
window.updateProduct = async function(){
  const id = document.getElementById("editProductId").value;
  const name = document.getElementById("productName").value;
  const price = document.getElementById("productPrice").value;
  const desc = document.getElementById("productDesc").value;
  const category = document.getElementById("productCategory").value;
  const file = document.getElementById("productImage").files[0];

  let imageUrl;
  if(file){
    const storageRef = ref(storage, "products/"+Date.now()+"_"+file.name);
    await uploadBytes(storageRef, file);
    imageUrl = await getDownloadURL(storageRef);
  }

  const productRef = doc(db,"products",id);
  const updateData = {name, price, desc, category};
  if(imageUrl) updateData.imageUrl = imageUrl;

  await updateDoc(productRef, updateData);
  alert("Product updated successfully!");
  clearForm();
  loadProducts();
}

// Clear form
function clearForm(){
  document.getElementById("productName").value="";
  document.getElementById("productPrice").value="";
  document.getElementById("productDesc").value="";
  document.getElementById("productCategory").value="Toothpaste";
  document.getElementById("productImage").value="";
  document.getElementById("uploadBtn").style.display="inline-block";
  document.getElementById("updateBtn").style.display="none";
  document.getElementById("editProductId").value="";
}

// Load Products
async function loadProducts(){
  const snapshot = await getDocs(collection(db,"products"));
  allProducts=[];
  snapshot.forEach(docSnap => {
    let data = docSnap.data();
    data.id = docSnap.id;
    allProducts.push(data);
  });
  displayProducts("All");
}

// Display Products
function displayProducts(category){
  const grid = document.getElementById("productGrid");
  grid.innerHTML="";
  const filtered = category==="All"? allProducts : allProducts.filter(p=>p.category===category);
  filtered.forEach(p=>{
    let adminButtons = '';
    if(document.getElementById("adminPanel").style.display==="flex"){
      adminButtons = `
      <div class="admin-btns">
      <button class="edit" onclick='editProduct(${JSON.stringify(p)})'>Edit</button>
      <button class="delete" onclick="deleteProduct('${p.id}')">Delete</button>
      </div>`;
    }
    grid.innerHTML += `
      <div class="card">
        <img src="${p.imageUrl}" alt="${p.name}">
        <div class="card-content">
          <h3>${p.name}</h3>
          <p>${p.desc}</p>
          <p class="price">‚Ç¶${p.price}</p>
          <small style="color:gray;">Category: ${p.category}</small>
        </div>
        <div class="contact-btns">
          <a class="call" href="tel:+2347060809088">üìû Call</a>
          <a class="whatsapp" href="https://wa.me/2347060809088?text=I%20want%20${encodeURIComponent(p.name)}">üí¨ WhatsApp</a>
        </div>
        ${adminButtons}
      </div>`;
  });
}
</script>
</body>
</html>