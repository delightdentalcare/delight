<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Delight Dental Care - Products</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f9f9f9; color:#333; }
    header { background:#008080; color:white; padding:20px; text-align:center; font-size:1.5rem; font-weight:bold; }
    nav { background:#006666; padding:10px; text-align:center; }
    nav a { color:white; text-decoration:none; margin:0 15px; font-weight:bold; }
    nav a:hover { text-decoration:underline; }
    .section-title { text-align:center; font-size:1.5rem; color:#008080; margin-top:30px; }
    .controls { display:flex; justify-content:center; gap:15px; padding:20px; }
    .controls input, .controls select { padding:10px; font-size:1rem; border-radius:5px; border:1px solid #ccc; width:250px; }
    .container { display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:20px; padding:20px; }
    .card { background:white; border-radius:10px; box-shadow:0 4px 6px rgba(0,0,0,0.1); overflow:hidden; transition:transform 0.2s; }
    .card:hover { transform:scale(1.03); }
    .card img { width:100%; height:200px; object-fit:cover; }
    .card-content { padding:15px; text-align:center; }
    .card-content h3 { margin:10px 0; color:#008080; }
    .card-content p { font-size:0.9rem; margin:10px 0; }
    .price { font-size:1.1rem; font-weight:bold; color:#006666; margin:10px 0; }
    .btn { display:inline-block; padding:10px 20px; background:#008080; color:white; border-radius:5px; text-decoration:none; font-weight:bold; margin:5px; }
    .btn:hover { background:#006666; }
    .reviews { margin-top:10px; font-size:0.9rem; color:#555; text-align:left; }
    .stars { color:gold; font-size:1.1rem; }
    footer { background:#008080; color:white; text-align:center; padding:15px; margin-top:20px; }
    #adminPanel { display:none; background:#fff; padding:20px; margin:20px auto; max-width:500px; border:1px solid #ccc; border-radius:10px; }
    #adminPanel input, #adminPanel textarea, #adminPanel select { width:100%; padding:10px; margin:10px 0; border:1px solid #ccc; border-radius:5px; }
    #loginPanel { text-align:center; margin:30px; }
  </style>
</head>
<body>
  <header>
    ü¶∑ Delight Dental Care - Our Products
  </header>
  <nav>
    <a href="index.html">Home</a>
    <a href="products.html">Products</a>
    <a href="comments.html">Public Comments</a>
    <a href="contact.html">Contact</a>
  </nav>

  <!-- Login for Admin -->
  <div id="loginPanel">
    <h2>Admin Login</h2>
    <input type="password" id="adminPassword" placeholder="Enter password">
    <button class="btn" onclick="checkPassword()">Login</button>
  </div>

  <!-- Admin Panel -->
  <div id="adminPanel">
    <h2>Add New Product</h2>
    <input type="text" id="productName" placeholder="Product Name">
    <textarea id="productDescription" placeholder="Product Description"></textarea>
    <input type="number" id="productPrice" placeholder="Price (‚Ç¶)">
    <select id="productCategory">
      <option value="toothpaste">Toothpaste</option>
      <option value="mouthwash">Mouthwash</option>
      <option value="floss">Floss</option>
      <option value="toothbrush">Toothbrush</option>
    </select>
    <input type="file" id="productImage">
    <button class="btn" onclick="uploadProduct()">Upload Product</button>
  </div>

  <!-- Search & Filter -->
  <h2 class="section-title">üõçÔ∏è Shop All Products</h2>
  <div class="controls">
    <input type="text" id="searchBar" placeholder="Search for a product...">
    <select id="categoryFilter">
      <option value="all">All Categories</option>
      <option value="toothpaste">Toothpaste</option>
      <option value="mouthwash">Mouthwash</option>
      <option value="floss">Floss</option>
      <option value="toothbrush">Toothbrush</option>
    </select>
  </div>

  <!-- Products -->
  <main class="container" id="productContainer"></main>

  <footer>
    &copy; 2025 Delight Dental Care | All Rights Reserved
  </footer>

  <!-- Firebase + Script -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";
    import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-storage.js";

    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyD1uU1UZdioHQWF7etIZ0tmz2MkwGhmThU",
      authDomain: "delight-program.firebaseapp.com",
      projectId: "delight-program",
      storageBucket: "delight-program.appspot.com",
      messagingSenderId: "972498440796",
      appId: "1:972498440796:web:e1220bf5dd8e82b7a0cc99"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);

    const password = "mubsbatir";
    const loginPanel = document.getElementById("loginPanel");
    const adminPanel = document.getElementById("adminPanel");
    const productContainer = document.getElementById("productContainer");
    const searchBar = document.getElementById("searchBar");
    const categoryFilter = document.getElementById("categoryFilter");

    // ‚úÖ Admin login
    window.checkPassword = function() {
      const input = document.getElementById("adminPassword").value;
      if (input === password) {
        loginPanel.style.display = "none";
        adminPanel.style.display = "block";
      } else {
        alert("Wrong password!");
      }
    };

    // ‚úÖ Upload product with image
    window.uploadProduct = async function() {
      const name = document.getElementById("productName").value;
      const description = document.getElementById("productDescription").value;
      const price = document.getElementById("productPrice").value;
      const category = document.getElementById("productCategory").value;
      const imageFile = document.getElementById("productImage").files[0];

      if (!name || !description || !price || !category || !imageFile) {
        alert("Please fill all fields and select an image.");
        return;
      }

      try {
        // Upload image
        const storageRef = ref(storage, "products/" + imageFile.name);
        await uploadBytes(storageRef, imageFile);
        const imageUrl = await getDownloadURL(storageRef);

        // Save product
        await addDoc(collection(db, "products"), {
          name, description, price, category, imageUrl
        });

        alert("Product added successfully!");
        loadProducts();
      } catch (error) {
        console.error("Error uploading product: ", error);
      }
    };

    // ‚úÖ Load products
    async function loadProducts() {
      productContainer.innerHTML = "";
      const querySnapshot = await getDocs(collection(db, "products"));
      querySnapshot.forEach(docSnap => {
        const product = docSnap.data();
        const productId = docSnap.id;
        const div = document.createElement("div");
        div.className = "card";
        div.setAttribute("data-category", product.category);
        div.innerHTML = `
          <img src="${product.imageUrl}" alt="${product.name}">
          <div class="card-content">
            <h3>${product.name}</h3>
            <p>${product.description}</p>
            <div class="price">‚Ç¶${product.price}</div>
            <a href="tel:+2347060809088" class="btn">üìû Call</a>
            <a href="https://wa.me/2347060809088?text=I%20want%20${encodeURIComponent(product.name)}" class="btn">üí¨ WhatsApp</a>
            <button class="btn" onclick="deleteProduct('${productId}')">‚ùå Delete</button>
          </div>`;
        productContainer.appendChild(div);
      });
    }

    // ‚úÖ Delete product
    window.deleteProduct = async function(id) {
      if (confirm("Delete this product?")) {
        await deleteDoc(doc(db, "products", id));
        loadProducts();
      }
    };

    // ‚úÖ Filter
    function filterProducts() {
      const searchText = searchBar.value.toLowerCase();
      const category = categoryFilter.value;
      document.querySelectorAll(".card").forEach(card => {
        const name = card.querySelector("h3").innerText.toLowerCase();
        const productCategory = card.getAttribute("data-category");
        const matchesSearch = name.includes(searchText);
        const matchesCategory = (category === "all" || category === productCategory);
        card.style.display = (matchesSearch && matchesCategory) ? "block" : "none";
      });
    }

    searchBar.addEventListener("input", filterProducts);
    categoryFilter.addEventListener("change", filterProducts);

    // Load products on page start
    loadProducts();
  </script>
</body>
</html>